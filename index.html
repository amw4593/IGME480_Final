<!DOCTYPE html>
<html lang="en">

<head>
    <!-- A-Frame -->
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>

    <!-- Pure three.js code that the A-Frame components use for location-based AR -->
    <script type='text/javascript'
        src='https://raw.githack.com/AR-js-org/AR.js/3.4.5/three.js/build/ar-threex-location-only.js'></script>

    <!-- AR.js A-Frame components -->
    <script type='text/javascript'
        src='https://raw.githack.com/AR-js-org/AR.js/3.4.5/aframe/build/aframe-ar.js'></script>
</head>

<body>
  <a-scene embedded arjs="sourceType: webcam;" fog="type: exponential; color: #220033; density: 0.03">

    <!-- Preload Assets -->
    <a-assets timeout="10000">
      <!-- Models -->
      <a-asset-item id="keyboardModel" src="assets/keyboard_and_mouse/scene.gltf"></a-asset-item>
      <a-asset-item id="starCarModel" src="assets/star_car/scene.gltf"></a-asset-item>

      <!-- Sound -->
      <audio id="ambientSound" src="assets/laststop.mp3" preload="auto"></audio>
    </a-assets>

    <!-- Global Sound -->
    <a-entity sound="src: #ambientSound; autoplay: true; loop: true; volume: 0.5"></a-entity>

    <!-- Lights -->
    <a-entity light="type: ambient; color: #222"></a-entity>
    <a-entity light="type: point; color: #ff00ff; intensity: 2; distance: 15" position="2 5 -3"></a-entity>
    <a-entity light="type: point; color: #00ffff; intensity: 2; distance: 15" position="-2 5 -3"></a-entity>

    <!-- Marker Setup -->
    <a-marker type="pattern" preset="custom"
      url="https://raw.githubusercontent.com/AR-js-org/AR.js/master/data/images/hiro.patt">

      <!-- Keyboard and Mouse Model -->
      <a-entity gltf-model="#keyboardModel" position="-1 0 -1" scale="0.3 0.3 0.3" rotation="0 90 0"></a-entity>

      <!-- Star Car Model -->
      <a-entity gltf-model="#starCarModel" position="1 0 -1" scale="0.4 0.4 0.4" rotation="0 -90 0"></a-entity>

      <!-- Billboard -->
      <a-entity position="0 2 -2">
        <a-plane width="2" height="1" color="#222" material="shader: flat"></a-plane>
        <a-text value="Welcome to RIT 2100!" position="-0.9 0.3 0" scale="1 1 1" color="#ffcc00"></a-text>
      </a-entity>
    </a-marker>

    <!-- Holographic NPC -->
    <a-entity position="0 1.5 -1">
      <a-plane width="1" height="2" color="#00ffff" material="opacity: 0.5"></a-plane>
      <a-text value="Hello, I am your guide from RIT 2100!" position="-0.5 0.8 0" scale="0.8 0.8 0.8"
        color="#ffffff"></a-text>
    </a-entity>

    <!-- Teleport Buttons -->
    <a-entity position="-1 1.5 -1">
      <a-plane width="0.5" height="0.2" color="#ff0000" material="shader: flat"
        onclick="teleportTo('spring_st')"></a-plane>
      <a-text value="Go to Spring St." position="-0.2 0 0.1" scale="0.5 0.5 0.5" color="#ffffff"></a-text>
    </a-entity>

    <a-entity position="1 1.5 -1">
      <a-plane width="0.5" height="0.2" color="#0000ff" material="shader: flat"
        onclick="teleportTo('golisano')"></a-plane>
      <a-text value="Go to Golisano" position="-0.2 0 0.1" scale="0.5 0.5 0.5" color="#ffffff"></a-text>
    </a-entity>

    <!-- History Panel -->
    <a-entity id="history-panel" position="0 1.5 -1" visible="false">
      <a-plane width="2" height="1" color="#111"></a-plane>
      <a-text value="Spring St: The original site of RIT before moving to Henrietta." position="-0.9 0.3 0"
        scale="0.8 0.8 0.8" color="#ffcc00"></a-text>
    </a-entity>

    <!-- Camera with Animated Tint -->
    <a-entity camera>
      <a-plane position="0 0 -1" width="2" height="2" color="#220033"
        material="shader: flat; opacity: 0.1; transparent: true"
        animation="property: material.opacity; from: 0.05; to: 0.2; dur: 3000; dir: alternate; loop: true">
      </a-plane>
    </a-entity>

    <!-- Teleport Script -->
    <script>
      function teleportTo(location) {
        document.querySelector('#history-panel').setAttribute('visible', location === 'spring_st');
      }
    </script>
  </a-scene>
</body>

</html>
